var strs = ggbs;
var ggbpure = "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";
if(strs[0]==""){
	strs[0] = ggbpure;
};
var c = 0;
var n = strs.length;

var cl = "";
if(bb){cl = "black";}else{cl = "white";}


var parameters = {
	"id": "ggbApplet",
	"width":1200,
	"height":620,
	"enableShiftDragZoom":true,
	"showMenuBar":bb,  
	"showAlgebraInput":bb,
	"showAlgebraInput":bb,
	"showToolBar":bb,
	"borderColor":cl,
	"ggbBase64": strs[c]
};
var applet = new GGBApplet(parameters,  '5.0');  


applet.setHTML5Codebase('./kz16lib/geogebra/5.0/web3d/');
window.onload = function() {applet.inject('ggbApplet');}; 

function saveGgbBase(){ 
	ggbApplet.getBase64(); 
};


document.getElementById("tolpages").value = n;

document.getElementById("Cpages").value = c+1;

function SetPage(){
	saveGgbBase();
	strs[c] = ggbApplet.getBase64();
	c = document.getElementById("Cpages").value - 1;
	ggbApplet.setBase64(strs[c]);
};

function Previous(){
	saveGgbBase();
	strs[c] = ggbApplet.getBase64();
	if(c==0){
		c = n - 1;
	}else{
		c = c - 1;
	}
	ggbApplet.setBase64(strs[c]);
	document.getElementById("Cpages").value = c+1;
	
};
function Next(){
	saveGgbBase();
	strs[c] = ggbApplet.getBase64();
	if(c== n-1){
		c = 0;
	}else{
		c = c + 1;
	}
	ggbApplet.setBase64(strs[c]);
	document.getElementById("Cpages").value = c+1;
};
function First(){
	saveGgbBase();
	strs[c] = ggbApplet.getBase64();
	c = 0;
	ggbApplet.setBase64(strs[c]);
	document.getElementById("Cpages").value = c+1;
};
function Last(){
	saveGgbBase();
	strs[c] = ggbApplet.getBase64();
	c = n-1;
	ggbApplet.setBase64(strs[c]);
	document.getElementById("Cpages").value = c+1;
};

function AddPage(){
	saveGgbBase();
	strs[c] = ggbApplet.getBase64();
	strs.splice(c+1, 0, ggbpure);
	n = n + 1;
	c = c + 1;
	ggbApplet.setBase64(ggbpure);
	document.getElementById("Cpages").value = c+1;
	document.getElementById("tolpages").value = n;
};


function DeletePage(){
	if(n!=1){
		strs.splice(c,1);
		n = n - 1;
		if(c==0){c = 0;}else{c = c - 1;}
		ggbApplet.setBase64(strs[c]);
		document.getElementById("Cpages").value = c+1;
		document.getElementById("tolpages").value = n;
	};
};


var btct = 0;
function Hidebt(){
	if(btct == 0){
		document.getElementById("bt").style.display="none";
		btct = 1;
	}
	else if(btct == 1){
		document.getElementById("bt").style.display="";
		btct = 0;
	}
};
document.onkeydown = function(){
	if((event).keyCode==40 || (event).keyCode==39)
		Next();
	if((event).keyCode==37 || (event).keyCode==38)
		Previous();
	if((event).keyCode==72)
		Hidebt();
	if((event).keyCode==32)
		SetPage();
	if((event).keyCode==82)
		Reset();
};



function saveGgbFile(){ 
	ggbApplet.getBase64(function(b){
		document.getElementById("Base64").value = b;
		document.getElementById("Base64").select();
		document.execCommand("copy");
	}); 
};
function loadGgbFile(){ ggbApplet.setBase64(document.getElementById("Base64").value); };



function savePPT(){ 
saveGgbBase();
strs[c] = ggbApplet.getBase64();

var tmp = "";
var chec = document.getElementsByName('kkk');
if(chec[0].checked){tmp = "true";}else{tmp = "false";}
var strxx =new Array();
strxx[0] = tmp;


strxx[0] = '<!DOCTYPE html><html><head>'+
'<meta charset="utf-8"\/><meta name=viewport content="width=device-width,initial-scale=1">'+
'<script src=".\/kz16lib\/geogebra\/deployggb.js"><\/script>'+
'<script src=".\/kz16lib\/FileSaver.js\/FileSaver.js"><\/script>'+
'<script>'+
'var bb = '+
tmp + 
';'+
'var ggbs=new Array();';

for(var i=0; i<n; i++){
	var tmpxxx = strs[i];
	strxx[i+1] = 'ggbs['+i+'] = "' + tmpxxx + '";';
};
strxx[n+1] = '<\/script>'+
'<\/head><body>'+
'<center><div id="ggbApplet" ><\/div><\/center>'+
'<div align="center" id="bt">'+
'<a href="javascript:saveGgbFile()">保存ggbBase64<\/a> '+
'<a href="javascript:loadGgbFile()">导入ggbBase64<\/a>'+
'<textarea name="Base64" id="Base64" cols=20 rows=1 style="resize:none;"><\/textarea>'+
'&nbsp;    '+
'<a href="javascript:savePPT()">导出<\/a>'+ 
'<label><input type="checkbox" name="kkk" value="true"></label>'+
'<textarea name="filename" id="filename" cols=8 rows=1 style="resize:none;">ggbppt<\/textarea>'+
'.html &nbsp;'+
'<a href="javascript:DeletePage()">删页<\/a>  '+
'<a href="javascript:AddPage()">加页<\/a>  '+
'<a href="javascript:First()">首页<\/a>  '+
'<a href="javascript:Previous()">上页<\/a>  '+
'<a href="javascript:SetPage()">跳转</a> '+
'<textarea name="Cpages" id="Cpages" cols=1 rows=1 style="resize:none; border-style:none;overflow:hidden;width:18px; text-align:right">1<\/textarea>'+
'\/'+
'<textarea name="tolpages" id="tolpages" cols=1 rows=1 style="resize:none; border-style:none;overflow:hidden;width:18px"><\/textarea>'+
'<a href="javascript:Next()">下页<\/a> '+
'<a href="javascript:Last()">尾页<\/a>'+
'<\/div>'+
'<script src="kz16lib\/pptggb.js"><\/script>'+
'<\/body><\/html>';

var blob = new Blob(strxx, {type: "text/html ;charset=utf-8"});
var name =document.getElementById("filename").value + '.html';
saveAs(blob, name);
};
